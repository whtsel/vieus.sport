<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vieus Sport - Premium Football Streams</title>
    <meta name="referrer" content="no-referrer">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        /* ===== UPDATED STYLES ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        :root {
            --primary-blue: #00ccff;
            --dark-bg: #0a0a12;
            --graphite: #1a1a1a;
            --wine-red: #8b0000;
            --cream-yellow: #fff8e1;
            --orange-cream: #ffd7b5;
            --cyan: #00ccff;
            --text-light: #ffffff;
            --text-gray: #cccccc;
            --glass-white: rgba(255, 255, 255, 0.1);
            --hot-color: #ff3366;
            --blue-gray: #5d7b9d;
            --countdown-red: #ff4444;
            --stream-red: #ff0000;
            --gold: #ffd700;
            --premium-gold: linear-gradient(45deg, #ffd700, #ffed4e);
        }

        body {
            background: var(--dark-bg);
            color: var(--text-light);
            min-height: 100vh;
            overflow-x: hidden;
            padding-bottom: 60px;
        }

        /* Background pattern */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('https://images.unsplash.com/photo-1543353074-8c8c8c6b7c1c?q=80&w=2070&auto=format&fit=crop');
            background-size: cover;
            background-position: center;
            opacity: 0.08;
            z-index: -1;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 16px;
        }

        /* ===== HEADER ===== */
        header {
            background: var(--graphite);
            padding: 12px 0;
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom: 1px solid var(--glass-white);
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            gap: 15px;
        }

        .logo {
            font-size: 1.4rem;
            font-weight: 700;
            color: white;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .logo i {
            color: var(--cyan);
            font-size: 1.6rem;
        }

        /* FOOTBALL TAB ON LEFT */
        .sport-header-tab {
            background: var(--cyan);
            color: var(--graphite);
            padding: 8px 20px;
            border-radius: 20px;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            margin-right: auto;
        }

        /* SEARCH BAR ON RIGHT */
        .search-container {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .search-bar {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid var(--glass-white);
            border-radius: 25px;
            padding: 10px 20px;
            color: var(--text-light);
            font-size: 0.9rem;
            width: 300px;
            transition: all 0.3s;
        }

        .search-bar:focus {
            outline: none;
            border-color: var(--cyan);
            background: rgba(255, 255, 255, 0.15);
            width: 350px;
        }

        .search-btn {
            background: var(--cyan);
            color: var(--graphite);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .search-btn:hover {
            background: #00a8e0;
            transform: scale(1.05);
        }

        /* ===== NOTIFICATION SLIDE BAR ===== */
        .notification-bar {
            position: fixed;
            top: 70px;
            right: 20px;
            background: var(--wine-red);
            color: white;
            padding: 12px 20px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
            z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            transform: translateX(150%);
            transition: transform 0.5s ease-in-out;
            max-width: 400px;
        }

        .notification-bar.show {
            transform: translateX(0);
        }

        .notification-icon {
            font-size: 1.2rem;
        }

        .notification-content {
            flex: 1;
        }

        .notification-title {
            font-weight: 600;
            font-size: 0.9rem;
        }

        .notification-message {
            font-size: 0.8rem;
            opacity: 0.9;
        }

        .notification-close {
            background: none;
            border: none;
            color: white;
            cursor: pointer;
            font-size: 0.9rem;
            opacity: 0.7;
            transition: opacity 0.3s;
        }

        .notification-close:hover {
            opacity: 1;
        }

        /* ===== LEAGUE GROUPING ===== */
        .league-section {
            margin-bottom: 30px;
        }

        .league-header {
            background: linear-gradient(90deg, rgba(139, 0, 0, 0.2), rgba(22, 22, 32, 0.8));
            padding: 12px 20px;
            border-radius: 12px;
            margin: 20px 0 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-left: 4px solid var(--wine-red);
            cursor: pointer;
            transition: all 0.3s ease;
            border: 1px solid rgba(255, 255, 255, 0.1);
            position: relative;
            overflow: hidden;
        }

        /* HOT INDICATOR */
        .hot-indicator {
            position: absolute;
            top: -10px;
            left: -10px;
            background: var(--hot-color);
            color: white;
            font-size: 0.7rem;
            font-weight: 700;
            padding: 12px 15px 5px 15px;
            transform: rotate(-45deg);
            transform-origin: center;
            z-index: 2;
            box-shadow: 0 2px 5px rgba(0,0,0,0.3);
        }

        .hot-indicator::after {
            content: "HOT";
            display: block;
            transform: rotate(45deg);
            text-align: center;
        }

        .league-header:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(139, 0, 0, 0.3);
            border-left: 4px solid var(--cyan);
        }

        .league-header-content {
            display: flex;
            align-items: center;
            gap: 12px;
            width: calc(100% - 100px);
        }

        .league-icon {
            width: 36px;
            height: 36px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .league-icon i {
            color: var(--cyan);
            font-size: 1.1rem;
        }

        .league-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .match-count {
            background: var(--wine-red);
            color: white;
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 700;
            flex-shrink: 0;
        }

        .league-matches {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 10px;
        }

        .league-section.collapsed .league-matches {
            display: none;
        }

        /* ===== MATCH CARDS ===== */
        .match-card {
            background: var(--graphite);
            border-radius: 16px;
            padding: 20px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        /* LIVE CARDS - WINE RED */
        .match-card.live {
            border: 2px solid var(--wine-red);
            border-left: 4px solid var(--wine-red);
        }

        .match-card.live .team-name,
        .match-card.live .match-league {
            color: white !important;
        }

        .match-card.live .match-time {
            color: var(--cream-yellow) !important;
            font-weight: 700;
        }

        /* UPCOMING CARDS - ORANGE CREAM */
        .match-card.upcoming {
            background: var(--orange-cream);
            border: 2px solid #ff9a3c;
        }

        .match-card.upcoming .team-name,
        .match-card.upcoming .match-league {
            color: #333 !important;
        }

        .match-card.upcoming .match-time {
            color: #333 !important;
            font-weight: 600;
        }

        .match-card.upcoming .team-logo {
            border: 2px solid rgba(0, 0, 0, 0.1);
        }

        /* Status badges */
        .match-status {
            position: absolute;
            top: 15px;
            right: 15px;
            padding: 6px 15px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            z-index: 2;
        }

        .status-live {
            background: var(--cream-yellow);
            color: var(--wine-red);
            font-weight: bold;
        }

        .status-upcoming {
            background: #333;
            color: var(--orange-cream);
            font-weight: bold;
        }

        /* UPDATED: Match info - more spacing */
        .match-info-header {
            margin-bottom: 25px;
            text-align: center;
            width: 100%;
            padding: 0 10px;
        }

        .match-league {
            font-size: 0.9rem;
            font-weight: 600;
            margin-bottom: 10px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            padding: 0 5px;
            color: #333;
            letter-spacing: 0.3px;
        }

        /* UPDATED: Fixture time styling */
        .match-time {
            font-size: 1.05rem;
            font-weight: 800;
            color: #000000;
            letter-spacing: 0.5px;
            text-transform: uppercase;
            background: rgba(255, 255, 255, 0.9);
            padding: 6px 12px;
            border-radius: 8px;
            display: inline-block;
            margin-top: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        .match-card.live .match-time {
            background: var(--wine-red);
            color: white !important;
        }

        /* Teams display */
        .teams-display {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin: 20px 0 40px;
            width: 100%;
            position: relative;
        }

        .team {
            display: flex;
            flex-direction: column;
            align-items: center;
            flex: 1;
        }

        /* UPDATED: Team logos with ash white background and dark glow */
        .team-logo {
            width: 85px;
            height: 85px;
            margin-bottom: 12px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid #f5f5f5;
            background: #f8f8f8;
            padding: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.6),
                        0 0 30px rgba(0, 0, 0, 0.4),
                        inset 0 0 15px rgba(255, 255, 255, 0.9);
            transition: all 0.4s ease;
            position: relative;
        }

        .match-card.upcoming .team-logo {
            background: #f8f8f8;
            border: 3px solid rgba(255, 107, 53, 0.3);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.5),
                        0 0 25px rgba(0, 0, 0, 0.3),
                        inset 0 0 15px rgba(255, 255, 255, 0.9);
        }

        .team-logo:hover {
            transform: translateY(-5px) scale(1.05);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.8),
                        0 0 40px rgba(0, 0, 0, 0.6),
                        0 0 0 3px rgba(0, 0, 0, 0.3),
                        inset 0 0 20px rgba(255, 255, 255, 0.8);
            border-color: rgba(0, 204, 255, 0.5);
        }

        .match-card.upcoming .team-logo:hover {
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.7),
                        0 0 40px rgba(0, 0, 0, 0.5),
                        0 0 0 3px rgba(255, 107, 53, 0.3),
                        inset 0 0 20px rgba(255, 255, 255, 0.8);
            border-color: rgba(255, 107, 53, 0.5);
        }

        .team-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
            transition: all 0.3s ease;
        }

        .team-logo:hover img {
            filter: drop-shadow(0 4px 8px rgba(0, 0, 0, 0.5)) brightness(1.05);
            transform: scale(1.05);
        }

        .team-name {
            font-size: 0.95rem;
            font-weight: 700;
            text-align: center;
            max-width: 120px;
            overflow: hidden;
            text-overflow: ellipsis;
            color: #333;
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 6px;
            margin-top: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        .match-card.live .team-name {
            background: rgba(139, 0, 0, 0.1);
            color: white;
        }

        .vs-divider {
            font-size: 1.4rem;
            font-weight: 900;
            color: var(--cyan);
            position: relative;
            z-index: 1;
            text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
            padding: 5px 10px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 8px;
        }

        .match-card.upcoming .vs-divider {
            color: #ff5722;
            background: rgba(0, 0, 0, 0.1);
        }

        /* UPDATED: Red countdown timer container */
        .countdown-container {
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--countdown-red);
            color: white;
            padding: 8px 20px;
            border-radius: 15px;
            font-size: 0.9rem;
            font-weight: 800;
            text-transform: uppercase;
            letter-spacing: 1px;
            box-shadow: 0 4px 15px rgba(255, 68, 68, 0.3),
                        0 0 20px rgba(255, 68, 68, 0.2);
            z-index: 2;
            width: auto;
            white-space: nowrap;
            border: 2px solid rgba(255, 255, 255, 0.3);
            min-width: 120px;
            text-align: center;
        }

        .match-card.live .countdown-container {
            display: none;
        }

        .countdown-timer {
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            letter-spacing: 2px;
            font-weight: 900;
            text-shadow: 0 1px 3px rgba(0, 0, 0, 0.5);
        }

        /* UPDATED: Countdown animation */
        @keyframes pulse {
            0% { transform: translateX(-50%) scale(1); }
            50% { transform: translateX(-50%) scale(1.05); }
            100% { transform: translateX(-50%) scale(1); }
        }

        .countdown-container {
            animation: pulse 2s infinite;
        }

        /* SINGLE WATCH BUTTON - CENTERED */
        .watch-btn-container {
            width: 100%;
            margin-top: 50px;
            display: flex;
            justify-content: center;
        }

        .watch-btn {
            padding: 12px 40px;
            background: var(--cyan);
            color: var(--graphite);
            border: none;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.95rem;
            display: flex;
            align-items: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .watch-btn:hover {
            background: #00a8e0;
            transform: translateY(-2px);
        }

        .match-card.upcoming .watch-btn {
            background: #ff6b35;
            color: white;
        }

        .match-card.upcoming .watch-btn:hover {
            background: #ff5722;
        }

        /* ===== SECTION HEADER ===== */
        .section-header {
            display: flex;
            align-items: center;
            gap: 15px;
            margin: 30px 0 20px;
        }

        .back-btn {
            background: var(--graphite);
            border: 1px solid var(--glass-white);
            color: var(--text-light);
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .back-btn:hover {
            background: var(--cyan);
            color: var(--graphite);
            transform: translateX(-3px);
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: white;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .section-title i {
            color: var(--cyan);
        }

        .section-actions {
            display: flex;
            gap: 8px;
            margin-left: auto;
        }

        .action-btn {
            padding: 8px 16px;
            background: var(--graphite);
            border: 1px solid var(--glass-white);
            border-radius: 10px;
            color: var(--text-light);
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .action-btn:hover {
            background: var(--cyan);
            color: var(--graphite);
        }

        /* ===== PREVIEW MODAL ===== */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.95);
            backdrop-filter: blur(5px);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 2000;
            padding: 20px;
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal-content {
            background: var(--graphite);
            border-radius: 20px;
            width: 100%;
            max-width: 800px;
            max-height: 90vh;
            overflow-y: auto;
            padding: 30px;
            border: 2px solid var(--wine-red);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        .modal-header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .modal-title {
            font-size: 2rem;
            font-weight: 700;
            color: white;
            line-height: 1.2;
            margin-bottom: 10px;
        }

        .modal-competition {
            color: var(--cyan);
            font-weight: 600;
            font-size: 1.1rem;
            margin-bottom: 20px;
            padding: 0 20px;
        }

        .modal-rating {
            color: #ffcc00;
            font-size: 1.3rem;
            margin: 10px 0 20px;
        }

        .modal-close {
            position: absolute;
            top: -10px;
            right: -10px;
            background: var(--graphite);
            border: 1px solid var(--glass-white);
            color: var(--text-gray);
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-size: 1.2rem;
            transition: all 0.3s;
        }

        .modal-close:hover {
            background: var(--cyan);
            color: var(--graphite);
            transform: rotate(90deg);
        }

        /* Teams in modal */
        .modal-teams {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 40px;
            margin: 30px 0;
        }

        .modal-team {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .modal-team-logo {
            width: 140px;
            height: 140px;
            border-radius: 50%;
            overflow: hidden;
            border: 3px solid var(--cream-yellow);
            background: #f8f8f8;
            padding: 15px;
            margin-bottom: 15px;
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.6),
                        0 0 35px rgba(0, 0, 0, 0.4),
                        inset 0 0 20px rgba(255, 255, 255, 0.8);
        }

        .modal-team-logo img {
            width: 100%;
            height: 100%;
            object-fit: contain;
            filter: drop-shadow(0 3px 5px rgba(0, 0, 0, 0.5));
        }

        .modal-team-name {
            font-size: 1.2rem;
            font-weight: 600;
            color: white;
            text-align: center;
            max-width: 200px;
        }

        .modal-vs {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--cyan);
        }

        /* Stream links section - UPDATED */
        .modal-streams {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid rgba(255, 255, 255, 0.1);
            display: none;
        }

        .modal-streams.active {
            display: block;
        }

        .streams-title {
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .streams-title i {
            color: var(--cyan);
        }

        .streams-list {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 15px;
        }

        /* UPDATED: Stream item with red TV logo and blinking text */
        .stream-item {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.1), rgba(139, 0, 0, 0.2));
            border-radius: 12px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: 2px solid var(--stream-red);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stream-item:hover {
            background: linear-gradient(135deg, rgba(255, 0, 0, 0.2), rgba(139, 0, 0, 0.3));
            transform: translateY(-3px);
            box-shadow: 0 5px 15px rgba(255, 0, 0, 0.3);
        }

        /* Red TV logo */
        .stream-tv-icon {
            color: var(--stream-red);
            font-size: 2rem;
            margin-bottom: 10px;
            display: block;
            text-shadow: 0 0 10px rgba(255, 0, 0, 0.5);
        }

        /* Blinking WATCH NOW text */
        .stream-watch-now {
            color: white;
            font-weight: 700;
            font-size: 0.9rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 5px;
            animation: blink 1.5s infinite;
            text-shadow: 0 0 5px rgba(255, 255, 255, 0.5);
        }

        @keyframes blink {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .stream-language {
            font-weight: 700;
            color: var(--cream-yellow);
            font-size: 1rem;
            margin-bottom: 5px;
        }

        .stream-quality {
            color: #ffcc99;
            font-size: 0.85rem;
            font-weight: 600;
        }

        .no-streams {
            text-align: center;
            padding: 40px 20px;
            color: var(--text-gray);
        }

        .no-streams i {
            font-size: 3rem;
            margin-bottom: 15px;
            opacity: 0.5;
            color: var(--stream-red);
        }

        .no-streams h4 {
            color: white;
            margin-bottom: 10px;
        }

        .no-streams p {
            font-size: 0.9rem;
            opacity: 0.8;
        }

        /* Modal actions */
        .modal-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .modal-btn {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 25px;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            font-size: 0.95rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .modal-btn.primary {
            background: var(--cyan);
            color: var(--graphite);
        }

        .modal-btn.primary:hover {
            background: #00a8e0;
            transform: translateY(-2px);
        }

        /* ===== MOBILE DOCK ===== */
        .mobile-dock {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: var(--graphite);
            padding: 12px 0;
            border-top: 1px solid var(--glass-white);
            z-index: 1000;
            display: flex;
            justify-content: space-around;
        }

        .dock-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            color: var(--text-gray);
            font-size: 0.7rem;
            padding: 8px 12px;
            cursor: pointer;
            transition: all 0.3s;
            border-radius: 12px;
            min-width: 60px;
            position: relative;
        }

        .dock-item i {
            font-size: 1.4rem;
            margin-bottom: 4px;
            transition: all 0.3s;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .dock-item[data-view="home"] i {
            background: var(--cyan);
            color: #000;
        }

        .dock-item[data-view="live"] i {
            background: #ff0000;
            color: #000000;
            border-radius: 8px;
        }

        .dock-item[data-view="upcoming"] i {
            background: var(--orange-cream);
            color: #333;
        }

        .dock-item:hover {
            color: var(--text-light);
        }

        .dock-item.active {
            color: var(--cyan);
            transform: translateY(-5px);
        }

        .dock-item.active i {
            transform: scale(1.1);
        }

        /* ===== FOOTER ===== */
        footer {
            background: var(--graphite);
            padding: 30px 0 80px;
            margin-top: 40px;
            border-top: 1px solid var(--glass-white);
        }

        /* ===== NEW PREMIUM PLAYER MODAL STYLES ===== */
        .player-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.98);
            z-index: 3000;
            display: none;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }

        .player-modal.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        .player-container {
            width: 100%;
            max-width: 1200px;
            height: 80vh;
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            border: 2px solid gold;
            display: flex;
            flex-direction: column;
            box-shadow: 0 0 50px rgba(255, 215, 0, 0.3);
        }

        .player-header {
            padding: 15px 20px;
            background: #111;
            border-bottom: 1px solid #222;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .player-title {
            font-size: 1.2rem;
            font-weight: 600;
            color: gold;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .player-close {
            background: #222;
            border: 1px solid #333;
            color: #aaa;
            width: 40px;
            height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
        }

        .player-close:hover {
            background: gold;
            color: #000;
        }

        .player-frame-container {
            flex: 1;
            position: relative;
            background: #000;
        }

        .player-frame {
            width: 100%;
            height: 100%;
            border: none;
        }

        /* Premium Ad Overlay */
        .premium-ad-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: #000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 20;
            padding: 30px;
            text-align: center;
            background-image: radial-gradient(circle at 50% 50%, rgba(255, 215, 0, 0.1), rgba(0, 0, 0, 0.9));
        }

        .premium-ad-overlay h2 {
            color: gold;
            font-size: 2.5rem;
            margin-bottom: 20px;
            letter-spacing: 3px;
            text-shadow: 0 0 20px rgba(255, 215, 0, 0.5);
            font-weight: 800;
            text-transform: uppercase;
        }

        .premium-ad-overlay p {
            color: #aaa;
            font-size: 1.1rem;
            max-width: 600px;
            line-height: 1.6;
            margin-bottom: 30px;
            font-weight: 300;
        }

        .premium-ad-btn {
            background: var(--premium-gold);
            color: #000;
            border: none;
            padding: 15px 50px;
            border-radius: 30px;
            font-size: 1.1rem;
            font-weight: 800;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 12px;
            letter-spacing: 1px;
            text-transform: uppercase;
            box-shadow: 0 5px 20px rgba(255, 215, 0, 0.4);
            margin-top: 20px;
        }

        .premium-ad-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(255, 215, 0, 0.6);
            background: linear-gradient(45deg, #ffed4e, #ffd700);
        }

        .premium-ad-btn:active {
            transform: translateY(0);
        }

        .shield-icon {
            font-size: 1.3rem;
            animation: pulse-shield 2s infinite;
        }

        @keyframes pulse-shield {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .encryption-status {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-top: 30px;
            color: #0af;
            font-size: 0.9rem;
            font-weight: 600;
        }

        .status-pulse {
            width: 10px;
            height: 10px;
            background: #0af;
            border-radius: 50%;
            animation: status-pulse 1.5s infinite;
        }

        @keyframes status-pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.5; transform: scale(1.2); }
        }

        /* Player Controls Bar */
        .player-controls {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.8);
            padding: 15px 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            z-index: 10;
            transition: opacity 0.3s;
        }

        .player-controls.hidden {
            opacity: 0;
            pointer-events: none;
        }

        .control-btn {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 1.1rem;
        }

        .control-btn:hover {
            background: gold;
            color: #000;
            transform: scale(1.1);
        }

        .quality-selector {
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quality-selector:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        /* Stream Quality Indicators */
        .quality-badge {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            font-weight: 700;
            margin-left: 8px;
        }

        .quality-hd {
            background: linear-gradient(45deg, #ff3366, #ff6b6b);
            color: white;
        }

        .quality-fhd {
            background: linear-gradient(45deg, #2196f3, #21cbf3);
            color: white;
        }

        .quality-uhd {
            background: linear-gradient(45deg, #9c27b0, #e91e63);
            color: white;
        }

        /* Stream Server Selection */
        .server-selection {
            position: absolute;
            top: 20px;
            right: 20px;
            z-index: 10;
            display: none;
        }

        .server-selector {
            background: rgba(0, 0, 0, 0.8);
            border: 1px solid gold;
            color: white;
            padding: 8px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            cursor: pointer;
            transition: all 0.3s;
        }

        .server-selector:hover {
            background: rgba(255, 215, 0, 0.2);
        }

        /* Loading Spinner */
        .loading-spinner {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 15;
            display: none;
        }

        .spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top: 4px solid gold;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        /* Error Overlay */
        .error-overlay {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 25;
            text-align: center;
            padding: 30px;
        }

        .error-overlay h3 {
            color: #ff4444;
            font-size: 1.5rem;
            margin-bottom: 15px;
        }

        .error-overlay p {
            color: #aaa;
            font-size: 1rem;
            margin-bottom: 25px;
            max-width: 500px;
        }

        .retry-btn {
            background: gold;
            color: #000;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 1rem;
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .retry-btn:hover {
            background: #ffed4e;
            transform: translateY(-2px);
        }

        /* Stream Stats */
        .stream-stats {
            position: absolute;
            top: 20px;
            left: 20px;
            background: rgba(0, 0, 0, 0.7);
            padding: 10px 15px;
            border-radius: 10px;
            font-size: 0.8rem;
            color: #0af;
            display: none;
            z-index: 10;
        }

        /* ===== RESPONSIVE DESIGN ===== */
        @media (max-width: 768px) {
            .league-matches {
                grid-template-columns: 1fr;
            }
            
            .mobile-dock {
                display: flex;
            }
            
            body {
                padding-bottom: 70px;
            }
            
            .modal-content {
                padding: 20px;
            }
            
            .modal-teams {
                gap: 20px;
            }
            
            .modal-team-logo {
                width: 100px;
                height: 100px;
            }
            
            .modal-title {
                font-size: 1.5rem;
            }
            
            .header-content {
                flex-wrap: wrap;
            }
            
            .search-bar {
                width: 200px;
            }
            
            .search-bar:focus {
                width: 250px;
            }
            
            .notification-bar {
                top: 60px;
                right: 10px;
                left: 10px;
                max-width: calc(100% - 20px);
            }
            
            .league-header-content {
                width: calc(100% - 90px);
            }
            
            .league-name {
                font-size: 1rem;
                max-width: 100%;
            }
            
            .match-count {
                padding: 5px 10px;
                font-size: 0.8rem;
            }
            
            .team-logo {
                width: 70px;
                height: 70px;
            }
            
            .countdown-container {
                bottom: -30px;
                font-size: 0.8rem;
                padding: 6px 15px;
                min-width: 100px;
            }
            
            .countdown-timer {
                font-size: 0.95rem;
                letter-spacing: 1px;
            }
            
            .match-time {
                font-size: 0.95rem;
                padding: 5px 10px;
            }
            
            .team-name {
                font-size: 0.85rem;
                padding: 3px 6px;
            }
            
            .modal-competition {
                padding: 0 10px;
                font-size: 1rem;
            }
            
            .streams-list {
                grid-template-columns: 1fr;
            }
            
            .stream-tv-icon {
                font-size: 1.8rem;
            }
            
            .stream-watch-now {
                font-size: 0.85rem;
            }
            
            /* Player modal mobile */
            .player-container {
                height: 100vh;
                border-radius: 0;
                border: none;
            }
            
            .player-header {
                padding: 10px 15px;
            }
            
            .player-title {
                font-size: 1rem;
            }
            
            .premium-ad-overlay h2 {
                font-size: 1.8rem;
            }
            
            .premium-ad-btn {
                padding: 12px 30px;
                font-size: 1rem;
            }
            
            .player-controls {
                padding: 10px 15px;
            }
        }

        @media (min-width: 769px) {
            .mobile-dock {
                display: none;
            }
            
            body {
                padding-bottom: 0;
            }
            
            footer {
                padding-bottom: 30px;
            }
        }

        @media (max-width: 480px) {
            .header-content {
                flex-direction: column;
                gap: 10px;
            }
            
            .team-logo {
                width: 60px;
                height: 60px;
                padding: 8px;
            }
            
            .modal-content {
                padding: 16px;
            }
            
            .modal-team-logo {
                width: 80px;
                height: 80px;
            }
            
            .modal-vs {
                font-size: 1.8rem;
            }
            
            .search-bar {
                width: 100%;
            }
            
            .search-bar:focus {
                width: 100%;
            }
            
            .league-name {
                font-size: 0.9rem;
            }
            
            .match-league {
                font-size: 0.85rem;
            }
            
            .countdown-container {
                bottom: -25px;
                font-size: 0.75rem;
                padding: 5px 12px;
                min-width: 90px;
            }
            
            .countdown-timer {
                font-size: 0.85rem;
                letter-spacing: 1px;
            }
            
            .match-time {
                font-size: 0.9rem;
                padding: 4px 8px;
            }
            
            .team-name {
                font-size: 0.8rem;
                padding: 2px 5px;
            }
            
            .modal-competition {
                font-size: 0.9rem;
                padding: 0 5px;
            }
            
            .modal-actions {
                flex-direction: column;
            }
            
            .stream-tv-icon {
                font-size: 1.5rem;
            }
            
            .stream-watch-now {
                font-size: 0.8rem;
            }
            
            .premium-ad-overlay h2 {
                font-size: 1.5rem;
            }
            
            .premium-ad-btn {
                padding: 10px 25px;
                font-size: 0.9rem;
            }
        }

        /* Scrollbar styling */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.1);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--cyan);
            border-radius: 4px;
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-play-circle"></i>
                    <span>Vieus Sport</span>
                </div>
                <div class="sport-header-tab">
                    <i class="fas fa-futbol"></i>
                    Football
                </div>
                <div class="search-container">
                    <input type="text" class="search-bar" id="searchBar" placeholder="Search matches, teams, leagues...">
                    <button class="search-btn" id="searchBtn">
                        <i class="fas fa-search"></i>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Notification Bar for Reminders -->
    <div class="notification-bar" id="notificationBar">
        <div class="notification-icon">
            <i class="fas fa-bell"></i>
        </div>
        <div class="notification-content">
            <div class="notification-title" id="notificationTitle">Stream Ready!</div>
            <div class="notification-message" id="notificationMessage">Premium stream loaded successfully</div>
        </div>
        <button class="notification-close" id="notificationClose">
            <i class="fas fa-times"></i>
        </button>
    </div>

    <!-- Main Content -->
    <div class="container">
        <!-- Section Header with Back Button -->
        <div class="section-header">
            <button class="back-btn" id="backBtn" style="display: none;">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2 class="section-title" id="sectionTitle">
                <i class="fas fa-broadcast-tower"></i> Live Matches
            </h2>
            <div class="section-actions">
                <button class="action-btn" id="refreshBtn">
                    <i class="fas fa-redo"></i> Refresh
                </button>
            </div>
        </div>
        
        <!-- Live Matches -->
        <div id="liveContainer">
            <!-- Dynamically populated with league grouping -->
        </div>

        <!-- Upcoming Matches Section -->
        <div class="section-header">
            <h2 class="section-title">
                <i class="far fa-clock"></i> Upcoming Matches
            </h2>
        </div>
        
        <div id="upcomingContainer">
            <!-- Dynamically populated with prioritized league grouping -->
        </div>
    </div>

    <!-- Mobile Dock Navigation -->
    <div class="mobile-dock">
        <div class="dock-item active" data-view="home">
            <i class="fas fa-home"></i>
            <span>Home</span>
        </div>
        <div class="dock-item" data-view="live">
            <i class="fas fa-broadcast-tower"></i>
            <span>Live</span>
        </div>
        <div class="dock-item" data-view="upcoming">
            <i class="far fa-clock"></i>
            <span>Upcoming</span>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-play-circle"></i>
                    Vieus Sport - Premium Football Streaming
                </div>
                <div class="copyright">
                    &copy; 2024 Vieus Sport. All rights reserved.
                </div>
            </div>
        </div>
    </footer>

    <!-- Preview Popup Modal -->
    <div class="modal-overlay" id="matchModal">
        <div class="modal-content">
            <div class="modal-header">
                <button class="modal-close" id="modalClose">
                    <i class="fas fa-times"></i>
                </button>
                <h3 class="modal-title" id="modalTitle">Match Details</h3>
                <div class="modal-competition" id="modalCompetition"></div>
                <div class="modal-rating" id="modalRating">★★★★★</div>
            </div>
            
            <div class="modal-teams" id="modalTeams">
                <!-- Dynamically populated -->
            </div>
            
            <div class="modal-streams" id="modalStreams">
                <h4 class="streams-title">
                    <i class="fas fa-stream"></i> Available Streams
                </h4>
                <div class="streams-list" id="streamsList">
                    <!-- Stream links will appear here -->
                </div>
            </div>
            
            <div class="modal-actions">
                <button class="modal-btn primary" id="modalWatchBtn">
                    <i class="fas fa-play"></i> WATCH NOW
                </button>
            </div>
        </div>
    </div>

    <!-- NEW: PREMIUM PLAYER MODAL -->
    <div class="player-modal" id="playerModal">
        <div class="player-container">
            <div class="player-header">
                <div class="player-title">
                    <i class="fas fa-play-circle"></i>
                    <span id="playerMatchTitle">Premium Stream</span>
                </div>
                <button class="player-close" id="playerClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="player-frame-container">
                <!-- Premium Ad Overlay -->
                <div class="premium-ad-overlay" id="premiumAdOverlay">
                    <h2>SIGNAL ENCRYPTED</h2>
                    <p>Your stream is protected by military-grade encryption. All pop-ups and redirects have been blocked for your security.</p>
                    <button class="premium-ad-btn" id="premiumAdBtn">
                        <i class="fas fa-shield-alt shield-icon"></i>
                        START STREAMING
                    </button>
                    <div class="encryption-status">
                        <div class="status-pulse"></div>
                        <span>ENCRYPTION ACTIVE • NO POP-UPS • NO REDIRECTS</span>
                    </div>
                </div>
                
                <!-- Loading Spinner -->
                <div class="loading-spinner" id="loadingSpinner">
                    <div class="spinner"></div>
                </div>
                
                <!-- Error Overlay -->
                <div class="error-overlay" id="errorOverlay">
                    <i class="fas fa-exclamation-triangle" style="font-size: 3rem; color: #ff4444; margin-bottom: 20px;"></i>
                    <h3>STREAM CONNECTION FAILED</h3>
                    <p>The stream could not be loaded. Please try another server or check your internet connection.</p>
                    <button class="retry-btn" id="retryBtn">
                        <i class="fas fa-redo"></i> RETRY CONNECTION
                    </button>
                </div>
                
                <!-- Stream Stats -->
                <div class="stream-stats" id="streamStats">
                    <i class="fas fa-wifi"></i> <span id="bitrate">0</span> kbps • 
                    <i class="fas fa-clock"></i> <span id="bufferTime">0</span>s
                </div>
                
                <!-- Server Selection -->
                <div class="server-selection" id="serverSelection">
                    <select class="server-selector" id="serverSelector">
                        <option value="">Select Server</option>
                    </select>
                </div>
                
                <!-- Player Controls -->
                <div class="player-controls" id="playerControls">
                    <div class="control-left">
                        <button class="control-btn" id="playPauseBtn">
                            <i class="fas fa-pause"></i>
                        </button>
                        <select class="quality-selector" id="qualitySelector">
                            <option value="auto">Auto Quality</option>
                            <option value="hd">HD 720p</option>
                            <option value="fhd">FHD 1080p</option>
                            <option value="uhd">UHD 4K</option>
                        </select>
                    </div>
                    <div class="control-right">
                        <button class="control-btn" id="fullscreenBtn">
                            <i class="fas fa-expand"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Player iframe with sandbox and referrer policies -->
                <iframe id="playerFrame" class="player-frame" 
                        sandbox="allow-scripts allow-same-origin allow-presentation allow-popups allow-forms"
                        allow="autoplay; fullscreen; picture-in-picture"
                        referrerpolicy="no-referrer"
                        allowfullscreen></iframe>
            </div>
        </div>
    </div>

    <script>
        // ===== CONFIGURATION =====
        const API_BASE_URL = 'https://raw.githubusercontent.com/whtsel/try/main/index.json';
        
        // Premium Aliez.tv proxy servers (rotated for reliability)
        const ALIEZ_SERVERS = [
            'https://emb.apl385.me/player/live.php',
            'https://cdn.livetv872.me/webplayer2.php',
            'https://cdn.livetv869.me/webplayer2.php',
            'https://cdn.livetv865.me/webplayer2.php'
        ];
        
        // Alternative fallback servers
        const FALLBACK_SERVERS = [
            'https://sportstreambest.onrender.com/aliez',
            'https://streamproxy.pages.dev/aliez'
        ];

        // ===== UPDATED PRIORITIZED COMPETITION ORDER - FIXED FOR EPL ONLY =====
        const PRIORITIZED_COMPETITIONS = [
            { 
                name: "Premier League", 
                keywords: ["england. premier league"],
                rank: 1,
                icon: "fas fa-crown",
                color: "#3d195b",
                hot: true
            },
            { 
                name: "FIFA World Cup (Qualifiers)", 
                keywords: ["world cup", "world cup qualifiers", "fifa world cup"],
                rank: 2,
                icon: "fas fa-globe-americas",
                color: "#1e90ff",
                hot: true
            },
            { 
                name: "FIFA Club World Cup", 
                keywords: ["club world cup", "fifa club world"],
                rank: 3,
                icon: "fas fa-trophy",
                color: "#ffd700",
                hot: true
            },
            { 
                name: "AFCON (Africa Cup of Nations)", 
                keywords: ["afcon", "africa cup", "african cup", "africa cup of nations"],
                rank: 4,
                icon: "fas fa-globe-africa",
                color: "#008000",
                hot: true
            },
            { 
                name: "UEFA Champions League", 
                keywords: ["champions league", "uefa champions"],
                rank: 5,
                icon: "fas fa-star",
                color: "#ff6b00",
                hot: true
            },
            { 
                name: "La Liga", 
                keywords: ["spain. la liga"],
                rank: 6,
                icon: "fas fa-futbol",
                color: "#ff0000",
                hot: true
            },
            { 
                name: "Bundesliga", 
                keywords: ["germany. bundesliga"],
                rank: 7,
                icon: "fas fa-shield-alt",
                color: "#dd0000",
                hot: true
            },
            { 
                name: "Serie A", 
                keywords: ["italy. serie a"],
                rank: 8,
                icon: "fas fa-flag",
                color: "#008c45",
                hot: true
            },
            { 
                name: "Ligue 1", 
                keywords: ["france. ligue 1"],
                rank: 9,
                icon: "fas fa-star",
                color: "#0d5eaf",
                hot: true
            },
            { 
                name: "Europa League", 
                keywords: ["europa league", "uefa europa"],
                rank: 10,
                icon: "fas fa-trophy",
                color: "#ff4500",
                hot: false
            },
            { 
                name: "FA Cup / Carabao Cup", 
                keywords: ["fa cup", "carabao cup", "efl cup"],
                rank: 11,
                icon: "fas fa-cup",
                color: "#ff0000",
                hot: false
            },
            { 
                name: "Nations League", 
                keywords: ["nations league", "uefa nations"],
                rank: 12,
                icon: "fas fa-flag",
                color: "#4b0082",
                hot: false
            },
            { 
                name: "EFL Championship", 
                keywords: ["england. championship"],
                rank: 13,
                icon: "fas fa-arrow-up",
                color: "#0d5eaf",
                hot: false
            }
        ];

        // ===== DOM ELEMENTS =====
        const liveContainer = document.getElementById('liveContainer');
        const upcomingContainer = document.getElementById('upcomingContainer');
        const backBtn = document.getElementById('backBtn');
        const sectionTitle = document.getElementById('sectionTitle');
        const refreshBtn = document.getElementById('refreshBtn');
        const dockItems = document.querySelectorAll('.dock-item');
        const matchModal = document.getElementById('matchModal');
        const modalClose = document.getElementById('modalClose');
        const streamsList = document.getElementById('streamsList');
        const modalStreams = document.getElementById('modalStreams');
        const modalWatchBtn = document.getElementById('modalWatchBtn');
        const searchBar = document.getElementById('searchBar');
        const searchBtn = document.getElementById('searchBtn');
        const notificationBar = document.getElementById('notificationBar');
        const notificationTitle = document.getElementById('notificationTitle');
        const notificationMessage = document.getElementById('notificationMessage');
        const notificationClose = document.getElementById('notificationClose');
        
        // Player modal elements
        const playerModal = document.getElementById('playerModal');
        const playerClose = document.getElementById('playerClose');
        const playerFrame = document.getElementById('playerFrame');
        const playerMatchTitle = document.getElementById('playerMatchTitle');
        const premiumAdOverlay = document.getElementById('premiumAdOverlay');
        const premiumAdBtn = document.getElementById('premiumAdBtn');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const errorOverlay = document.getElementById('errorOverlay');
        const retryBtn = document.getElementById('retryBtn');
        const streamStats = document.getElementById('streamStats');
        const serverSelection = document.getElementById('serverSelection');
        const serverSelector = document.getElementById('serverSelector');
        const playerControls = document.getElementById('playerControls');
        const playPauseBtn = document.getElementById('playPauseBtn');
        const qualitySelector = document.getElementById('qualitySelector');
        const fullscreenBtn = document.getElementById('fullscreenBtn');
        const bitrateElement = document.getElementById('bitrate');
        const bufferTimeElement = document.getElementById('bufferTime');

        // ===== GLOBAL VARIABLES =====
        let allMatches = [];
        let filteredMatches = [];
        let currentView = 'home';
        let currentModalMatch = null;
        let userReminders = JSON.parse(localStorage.getItem('vieusReminders')) || [];
        let countdownTimers = {};
        let currentStreamId = null;
        let currentStreamUrl = null;
        let currentServerIndex = 0;
        let isPlaying = false;
        let isFullscreen = false;
        let serverRetryCount = 0;
        const MAX_RETRIES = 3;
        
        // Stream server rotation
        let availableServers = [...ALIEZ_SERVERS];

        // ===== UPDATED LOGO HANDLING FUNCTION =====
        function getTeamLogo(teamName, logoUrl) {
            // Clean team name for matching
            const cleanTeamName = teamName.trim()
                .replace('(W)', '') // Remove (W) from women's teams
                .trim();
            
            // If a valid logo URL is provided in the data, ALWAYS use it first
            if (logoUrl && 
                typeof logoUrl === 'string' && 
                logoUrl.trim() !== '' && 
                logoUrl !== 'null' && 
                logoUrl !== 'undefined' &&
                !logoUrl.includes('placeholder')) {
                
                // Fix the URL to ensure it's properly formatted
                let fixedUrl = logoUrl.trim();
                
                // Fix common URL issues
                if (fixedUrl.startsWith('//')) {
                    fixedUrl = 'https:' + fixedUrl;
                }
                
                if (fixedUrl.startsWith('/')) {
                    fixedUrl = 'https:' + fixedUrl;
                }
                
                // Ensure it's a proper URL
                if (fixedUrl.startsWith('http')) {
                    // Return the original logo URL from the data
                    return fixedUrl;
                }
            }
            
            // Only if no logo URL is provided in the data, use fallback system
            // Clean team name for fallback matching
            const cleanName = cleanTeamName.toLowerCase();
            
            // Specific team fallbacks for common teams in your data
            const teamFallbacks = {
                // Italy Serie A
                'parma': 'https://upload.wikimedia.org/wikipedia/en/0/00/Parma_Calcio_1913_logo.svg',
                'fiorentina': 'https://upload.wikimedia.org/wikipedia/en/2/2b/ACF_Fiorentina_logo.svg',
                'lecce': 'https://upload.wikimedia.org/wikipedia/en/5/5d/U.S._Lecce_logo.svg',
                'como': 'https://upload.wikimedia.org/wikipedia/en/7/7d/Como_1907_logo.svg',
                'torino': 'https://upload.wikimedia.org/wikipedia/en/1/1d/Torino_FC_Logo.svg',
                'cagliari': 'https://upload.wikimedia.org/wikipedia/en/6/69/Cagliari_Calcio_1920_logo.svg',
                'udinese': 'https://upload.wikimedia.org/wikipedia/en/7/71/Udinese_Calcio_logo.svg',
                'lazio': 'https://upload.wikimedia.org/wikipedia/en/5/53/SS_Lazio_logo.svg',
                'juventus': 'https://upload.wikimedia.org/wikipedia/en/0/0c/Juventus_FC_2017_logo.svg',
                
                // England Premier League
                'arsenal': 'https://upload.wikimedia.org/wikipedia/en/5/53/Arsenal_FC.svg',
                'manchester city': 'https://upload.wikimedia.org/wikipedia/en/e/eb/Manchester_City_FC_badge.svg',
                'liverpool': 'https://upload.wikimedia.org/wikipedia/en/0/0c/Liverpool_FC.svg',
                'chelsea': 'https://upload.wikimedia.org/wikipedia/en/c/cc/Chelsea_FC.svg',
                'aston villa': 'https://upload.wikimedia.org/wikipedia/en/9/9f/Aston_Villa_logo.svg',
                'west ham united': 'https://upload.wikimedia.org/wikipedia/en/c/c2/West_Ham_United_FC_logo.svg',
                'wolverhampton': 'https://upload.wikimedia.org/wikipedia/en/f/fc/Wolverhampton_Wanderers.svg',
                'brentford': 'https://upload.wikimedia.org/wikipedia/en/2/2a/Brentford_FC_crest.svg',
                'bournemouth': 'https://upload.wikimedia.org/wikipedia/en/e/e5/AFC_Bournemouth_%282013%29.svg',
                'burnley': 'https://upload.wikimedia.org/wikipedia/en/6/6d/Burnley_FC_Logo.svg',
                'everton': 'https://upload.wikimedia.org/wikipedia/en/7/7c/Everton_FC_logo.svg',
                'nottingham forest': 'https://upload.wikimedia.org/wikipedia/en/e/e5/Nottingham_Forest_F.C._logo.svg',
                'fulham': 'https://upload.wikimedia.org/wikipedia/en/e/eb/Fulham_FC_%28shield%29.svg',
                'brighton': 'https://upload.wikimedia.org/wikipedia/en/f/fd/Brighton_%26_Hove_Albion_logo.svg',
                
                // Australia A-League
                'adelaide united': 'https://upload.wikimedia.org/wikipedia/en/6/6d/Adelaide_United_FC_logo.svg',
                'western sydney': 'https://upload.wikimedia.org/wikipedia/en/8/8b/Western_Sydney_Wanderers_FC_logo.svg',
                'sydney': 'https://upload.wikimedia.org/wikipedia/en/4/48/Sydney_FC_logo.svg',
                'auckland': 'https://upload.wikimedia.org/wikipedia/en/thumb/4/43/Auckland_City_FC_logo.svg/256px-Auckland_City_FC_logo.svg.png',
                'central coast mariners': 'https://upload.wikimedia.org/wikipedia/en/5/5b/Central_Coast_Mariners_FC_logo.svg',
                'melbourne victory': 'https://upload.wikimedia.org/wikipedia/en/2/28/Melbourne_Victory_FC_logo.svg',
                'newcastle jets': 'https://upload.wikimedia.org/wikipedia/en/6/69/Newcastle_Jets_FC_logo.svg',
                'canberra united': 'https://upload.wikimedia.org/wikipedia/en/8/8c/Canberra_United_FC_logo.svg',
                
                // Saudi Pro League
                'al nassr': 'https://upload.wikimedia.org/wikipedia/en/9/9e/Al_Nassr_FC_Logo.svg',
                'al-ittihad jeddah': 'https://upload.wikimedia.org/wikipedia/en/4/41/Al-Ittihad_Club_%28Jeddah%29_Logo.svg',
                'al-shabab riyadh': 'https://upload.wikimedia.org/wikipedia/en/c/c5/Al-Shabab_FC_%28Riyadh%29_logo.svg',
                
                // Other teams
                'hibernian': 'https://upload.wikimedia.org/wikipedia/en/5/5a/Hibernian_FC_logo.svg',
                'hearts': 'https://upload.wikimedia.org/wikipedia/en/5/5d/Heart_of_Midlothian_FC_logo.svg',
                'celtic': 'https://upload.wikimedia.org/wikipedia/en/5/5d/Celtic_FC_logo.svg',
                'rangers': 'https://upload.wikimedia.org/wikipedia/en/4/43/Rangers_FC_logo.svg',
                
                // Default fallback
                'default': 'https://upload.wikimedia.org/wikipedia/commons/a/ac/No_image_available.svg'
            };
            
            // Check for exact match first
            if (teamFallbacks[cleanName]) {
                return teamFallbacks[cleanName];
            }
            
            // Check for partial matches
            for (const [key, url] of Object.entries(teamFallbacks)) {
                if (cleanName.includes(key) || key.includes(cleanName)) {
                    return url;
                }
            }
            
            // If no match found, generate a colored avatar
            return `https://ui-avatars.com/api/?name=${encodeURIComponent(cleanTeamName)}&background=random&color=fff&size=256&bold=true`;
        }

        // ===== INITIALIZATION =====
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupEventListeners();
            
            // Initialize server selector
            updateServerSelector();
            
            // Hide controls initially
            playerControls.classList.add('hidden');
            
            // Simulate stream stats
            simulateStreamStats();
        });

        // ===== UPDATED COUNTDOWN TIMER FUNCTION =====
        function updateCountdown(matchId, startTime) {
            const now = new Date();
            const matchDate = new Date(startTime);
            
            if (isNaN(matchDate.getTime())) {
                return "Invalid time";
            }
            
            const diff = matchDate.getTime() - now.getTime();
            
            if (diff <= 0) {
                if (countdownTimers[matchId]) {
                    clearInterval(countdownTimers[matchId]);
                    delete countdownTimers[matchId];
                }
                return "Match Started";
            }
            
            const days = Math.floor(diff / (1000 * 60 * 60 * 24));
            const hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
            const minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
            const seconds = Math.floor((diff % (1000 * 60)) / 1000);
            
            if (days > 0) {
                return `${days}d ${hours}h ${minutes}m`;
            } else if (hours > 0) {
                return `${hours}h ${minutes}m ${seconds}s`;
            } else {
                return `${minutes}m ${seconds}s`;
            }
        }

        function startCountdownTimers() {
            const upcomingCards = document.querySelectorAll('.match-card.upcoming');
            
            upcomingCards.forEach(card => {
                const matchId = card.dataset.matchId;
                const startTime = card.dataset.startTime;
                
                if (!matchId || !startTime) return;
                
                if (countdownTimers[matchId]) {
                    clearInterval(countdownTimers[matchId]);
                }
                
                const countdownElement = card.querySelector('.countdown-timer');
                if (countdownElement) {
                    countdownElement.textContent = updateCountdown(matchId, startTime);
                }
                
                countdownTimers[matchId] = setInterval(() => {
                    const countdownElement = card.querySelector('.countdown-timer');
                    if (countdownElement) {
                        const newTime = updateCountdown(matchId, startTime);
                        countdownElement.textContent = newTime;
                        
                        if (newTime === "Match Started") {
                            clearInterval(countdownTimers[matchId]);
                            delete countdownTimers[matchId];
                        }
                    }
                }, 1000);
            });
        }

        // ===== UPDATED DATA LOADING WITH DUPLICATE REMOVAL =====
        async function loadData() {
            try {
                showLoading();
                
                const response = await fetch(API_BASE_URL);
                if (!response.ok) throw new Error('Network response failed');
                
                const data = await response.json();
                
                // Use Set to track unique matches
                const uniqueMatches = new Map();
                const liveMatches = [];
                const upcomingMatches = [];
                
                data.forEach(match => {
                    // Basic validation
                    if (!match.matchup || !match.team_logos) return;
                    
                    // Split matchup to get team names
                    const teams = match.matchup.split(' – ');
                    if (teams.length < 2) return;
                    
                    const homeTeam = teams[0]?.trim();
                    const awayTeam = teams[1]?.trim();
                    
                    // Validate team names
                    const hasValidHomeName = homeTeam && 
                                            homeTeam.trim() !== '' && 
                                            homeTeam.length > 2 &&
                                            !homeTeam.toLowerCase().includes('undefined') &&
                                            homeTeam !== 'Simulcast';
                    
                    const hasValidAwayName = awayTeam && 
                                            awayTeam.trim() !== '' && 
                                            awayTeam.length > 2 &&
                                            !awayTeam.toLowerCase().includes('undefined') &&
                                            awayTeam !== 'Simulcast';
                    
                    if (!hasValidHomeName || !hasValidAwayName) return;
                    
                    // Check for team logos (with more lenient validation)
                    const homeLogo = match.team_logos[0]?.logo_url;
                    const awayLogo = match.team_logos[1]?.logo_url;
                    
                    // Accept any logo URL as long as it's not obviously broken
                    const hasAnyLogo = (homeLogo && typeof homeLogo === 'string' && homeLogo.trim() !== '') ||
                                     (awayLogo && typeof awayLogo === 'string' && awayLogo.trim() !== '');
                    
                    if (!hasAnyLogo) return;
                    
                    // Create unique identifier for duplicate checking
                    const uniqueId = `${homeTeam}-${awayTeam}-${match.competition || ''}-${match.parsed_datetime || ''}`;
                    
                    // Skip if we've already seen this match
                    if (uniqueMatches.has(uniqueId)) {
                        console.log(`Skipping duplicate: ${homeTeam} vs ${awayTeam}`);
                        return;
                    }
                    
                    // Mark as seen
                    uniqueMatches.set(uniqueId, true);
                    
                    // Check if match is from prioritized competition
                    const priorityInfo = getCompetitionPriority(match);
                    
                    // For LIVE matches: require Aliez.tv streams
                    if (match.is_live) {
                        // Check for Aliez.tv streams
                        const hasAliezStream = match.streams && match.streams.some(stream => 
                            stream.stream_url && 
                            (stream.stream_url.includes('aliez.tv') || 
                             stream.stream_url.includes('alieztv') ||
                             stream.stream_url.includes('webplayer2.php?t=alieztv') ||
                             stream.stream_url.includes('player/live.php?id='))
                        );
                        
                        if (hasAliezStream) {
                            liveMatches.push(match);
                        }
                    } 
                    // For UPCOMING matches: show if from prioritized competition
                    else {
                        if (priorityInfo !== null) {
                            upcomingMatches.push(match);
                        }
                    }
                });
                
                // Remove duplicates from upcoming matches by checking for same teams within short time window
                const filteredUpcomingMatches = [];
                const seenCombinations = new Set();
                
                upcomingMatches.forEach(match => {
                    const teams = match.matchup.split(' – ');
                    const homeTeam = teams[0]?.trim().toLowerCase();
                    const awayTeam = teams[1]?.trim().toLowerCase();
                    const combination = `${homeTeam}-${awayTeam}`;
                    
                    // Only add if we haven't seen this combination recently
                    if (!seenCombinations.has(combination)) {
                        seenCombinations.add(combination);
                        filteredUpcomingMatches.push(match);
                    } else {
                        console.log(`Filtered duplicate upcoming match: ${match.matchup}`);
                    }
                });
                
                // Combine matches
                allMatches = [...liveMatches, ...filteredUpcomingMatches];
                console.log(`Loaded ${liveMatches.length} live matches and ${filteredUpcomingMatches.length} upcoming matches (after deduplication)`);
                filteredMatches = [...allMatches];
                renderAllMatches();
            } catch (error) {
                console.error('Error loading data:', error);
                showError();
            }
        }

        function showLoading() {
            liveContainer.innerHTML = `
                <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                    <i class="fas fa-spinner fa-spin fa-2x"></i>
                    <p style="margin-top: 15px;">Loading live matches...</p>
                </div>
            `;
            
            upcomingContainer.innerHTML = `
                <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                    <i class="fas fa-spinner fa-spin fa-2x"></i>
                    <p style="margin-top: 15px;">Loading upcoming matches...</p>
                </div>
            `;
        }

        function showError() {
            const errorHtml = `
                <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                    <i class="fas fa-exclamation-triangle fa-2x"></i>
                    <h3 style="color: var(--text-light); margin: 15px 0 10px;">Connection Error</h3>
                    <p>Unable to load matches. Please try again later.</p>
                    <button class="watch-btn" onclick="loadData()" style="margin-top: 20px; width: auto; padding: 10px 30px;">
                        <i class="fas fa-redo"></i> Retry
                    </button>
                </div>
            `;
            
            liveContainer.innerHTML = errorHtml;
            upcomingContainer.innerHTML = errorHtml;
        }

        // ===== EXTRACT ALIEZ.TV STREAM ID =====
        function extractAliezStreamId(streamUrl) {
            if (!streamUrl) return null;
            
            // Try to extract channel ID from Aliez.tv URL
            const patterns = [
                /id=(\d+)/i,  // Extract from id= parameter
                /c=(\d+)/i,   // Extract from c= parameter
                /channel.*?(\d+)/i,
                /(\d+)(?=&|$)/i  // Look for standalone numbers
            ];
            
            for (const pattern of patterns) {
                const match = streamUrl.match(pattern);
                if (match && match[1]) {
                    return match[1];
                }
            }
            
            // Default fallback ID
            return "245303";
        }

        // ===== BUILD SECURE STREAM URL =====
        function buildSecureStreamUrl(streamId) {
            // Rotate through available servers for load balancing
            const server = availableServers[currentServerIndex];
            
            // Increment server index for next request
            currentServerIndex = (currentServerIndex + 1) % availableServers.length;
            
            // Determine URL structure based on server
            if (server.includes('player/live.php')) {
                // emb.apl385.me format
                return `${server}?id=${streamId}&autoplay=1&no_popups=1&referrer=${encodeURIComponent(window.location.origin)}`;
            } else if (server.includes('webplayer2.php')) {
                // cdn.livetv format
                return `${server}?t=alieztv&c=${streamId}&lang=en&autoplay=1&no_redirects=1`;
            } else {
                // Generic format
                return `${server}?id=${streamId}&autoplay=1`;
            }
        }

        // ===== UPDATE SERVER SELECTOR =====
        function updateServerSelector() {
            serverSelector.innerHTML = '<option value="">Select Server</option>';
            
            availableServers.forEach((server, index) => {
                const option = document.createElement('option');
                option.value = index;
                option.textContent = `Server ${index + 1} (${new URL(server).hostname})`;
                if (index === currentServerIndex) {
                    option.selected = true;
                }
                serverSelector.appendChild(option);
            });
        }

        // ===== SIMULATE STREAM STATS =====
        function simulateStreamStats() {
            setInterval(() => {
                if (isPlaying && playerFrame.src) {
                    // Simulate realistic bitrate (1-5 Mbps)
                    const bitrate = Math.floor(Math.random() * 4000) + 1000;
                    const bufferTime = (Math.random() * 2).toFixed(1);
                    
                    bitrateElement.textContent = bitrate;
                    bufferTimeElement.textContent = bufferTime;
                }
            }, 2000);
        }

        // ===== SEARCH FUNCTIONALITY =====
        function performSearch() {
            const searchTerm = searchBar.value.toLowerCase().trim();
            
            if (!searchTerm) {
                filteredMatches = [...allMatches];
            } else {
                filteredMatches = allMatches.filter(match => {
                    const teams = match.matchup ? match.matchup.split(' – ') : ['', ''];
                    const homeTeam = teams[0]?.toLowerCase() || '';
                    const awayTeam = teams[1]?.toLowerCase() || '';
                    const competition = (match.competition || '').toLowerCase();
                    
                    return homeTeam.includes(searchTerm) || 
                           awayTeam.includes(searchTerm) || 
                           competition.includes(searchTerm);
                });
            }
            
            renderAllMatches();
        }

        // ===== UPDATED GET COMPETITION PRIORITY - STRICTER EPL CHECK =====
        function getCompetitionPriority(match) {
            const competitionName = (match.competition || '').toLowerCase();
            
            for (const comp of PRIORITIZED_COMPETITIONS) {
                for (const keyword of comp.keywords) {
                    // Exact match for EPL - only show England Premier League, not other premier leagues
                    if (comp.name === "Premier League") {
                        // Strict check for English Premier League only
                        if (competitionName === "england. premier league" || 
                            competitionName === "england premier league" ||
                            competitionName.includes("england. premier league")) {
                            return {
                                ...comp,
                                displayName: "Premier League (EPL)",
                                rank: comp.rank
                            };
                        }
                    } else {
                        // For other competitions, use normal keyword matching
                        if (competitionName.includes(keyword.toLowerCase())) {
                            return {
                                ...comp,
                                displayName: comp.name,
                                rank: comp.rank
                            };
                        }
                    }
                }
            }
            
            // Return null for matches not in prioritized list
            return null;
        }

        // ===== GROUP MATCHES BY PRIORITIZED COMPETITIONS (FOR UPCOMING) =====
        function groupMatchesByPriority(matches) {
            const groups = {};
            
            // Initialize groups for each prioritized competition
            PRIORITIZED_COMPETITIONS.forEach(comp => {
                const displayName = comp.name === "Premier League" ? "Premier League (EPL)" : comp.name;
                groups[comp.name] = {
                    competition: comp.name,
                    displayName: displayName,
                    matches: [],
                    importance: comp.rank,
                    icon: comp.icon,
                    color: comp.color,
                    hot: comp.hot || false
                };
            });
            
            // Assign matches to groups
            matches.forEach(match => {
                const priorityInfo = getCompetitionPriority(match);
                if (priorityInfo && groups[priorityInfo.name]) {
                    groups[priorityInfo.name].matches.push(match);
                }
            });
            
            // Convert to array, sort by rank, and filter out empty groups
            const groupsArray = Object.values(groups)
                .filter(group => group.matches.length > 0)
                .sort((a, b) => a.importance - b.importance);
            
            return groupsArray;
        }

        // ===== RENDER MATCHES =====
        function renderAllMatches() {
            const liveMatches = filteredMatches.filter(match => match.is_live);
            const upcomingMatches = filteredMatches.filter(match => !match.is_live);

            // Render live matches with regular grouping
            renderLiveMatches(liveContainer, liveMatches);
            
            // Render upcoming matches with prioritized competition grouping
            renderUpcomingMatches(upcomingContainer, upcomingMatches);
            
            setTimeout(startCountdownTimers, 100);
        }

        function renderLiveMatches(container, matches) {
            container.innerHTML = '';

            if (matches.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                        <i class="fas fa-tv-slash fa-2x"></i>
                        <h3 style="color: var(--text-light); margin: 15px 0 10px;">No Live Matches</h3>
                        <p>Check back later or explore upcoming matches</p>
                    </div>
                `;
                return;
            }

            // Group live matches by competition
            const groups = {};
            matches.forEach(match => {
                const compName = match.competition || "Other Matches";
                
                // Special handling for EPL in live matches
                let displayName = compName;
                if (compName.toLowerCase().includes("england. premier league")) {
                    displayName = "Premier League (EPL)";
                }
                
                if (!groups[compName]) {
                    groups[compName] = {
                        competition: compName,
                        displayName: displayName,
                        matches: [],
                        color: "#8b0000",
                        icon: "fas fa-broadcast-tower",
                        hot: true
                    };
                }
                groups[compName].matches.push(match);
            });

            // Sort groups and create league sections
            Object.values(groups).sort((a, b) => {
                // Put Premier League and Champions League first
                const aIsImportant = a.competition.toLowerCase().includes('england. premier league') || 
                                   a.competition.toLowerCase().includes('champions');
                const bIsImportant = b.competition.toLowerCase().includes('england. premier league') || 
                                   b.competition.toLowerCase().includes('champions');
                
                if (aIsImportant && !bIsImportant) return -1;
                if (!aIsImportant && bIsImportant) return 1;
                
                // Otherwise sort alphabetically
                return a.competition.localeCompare(b.competition);
            }).forEach(group => {
                createLeagueSection(container, group, true);
            });
        }

        function renderUpcomingMatches(container, matches) {
            container.innerHTML = '';

            if (matches.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                        <i class="fas fa-tv-slash fa-2x"></i>
                        <h3 style="color: var(--text-light); margin: 15px 0 10px;">No Upcoming Matches</h3>
                        <p>Check back later for scheduled matches</p>
                    </div>
                `;
                return;
            }

            // Group upcoming matches by prioritized competitions
            const groups = groupMatchesByPriority(matches);
            
            if (groups.length === 0) {
                container.innerHTML = `
                    <div style="text-align: center; padding: 40px; color: var(--text-gray);">
                        <i class="fas fa-calendar-alt fa-2x"></i>
                        <h3 style="color: var(--text-light); margin: 15px 0 10px;">No Prioritized Matches</h3>
                        <p>No matches from prioritized competitions found</p>
                    </div>
                `;
                return;
            }

            // Create league sections for each prioritized group
            groups.forEach(group => {
                createLeagueSection(container, group, false);
            });
        }

        function createLeagueSection(container, group, isLive) {
            const leagueSection = document.createElement('div');
            leagueSection.className = 'league-section';
            
            const leagueHeader = document.createElement('div');
            leagueHeader.className = 'league-header';
            leagueHeader.style.borderLeftColor = group.color;
            leagueHeader.onclick = function() {
                leagueSection.classList.toggle('collapsed');
            };
            
            if (group.hot) {
                const hotIndicator = document.createElement('div');
                hotIndicator.className = 'hot-indicator';
                leagueHeader.appendChild(hotIndicator);
            }
            
            leagueHeader.innerHTML = `
                <div class="league-header-content">
                    <div class="league-icon" style="background: ${group.color}20;">
                        <i class="${group.icon}" style="color: ${group.color};"></i>
                    </div>
                    <div class="league-name">${group.displayName}</div>
                </div>
                <div class="match-count" style="background: ${group.color};">
                    ${group.matches.length} match${group.matches.length > 1 ? 'es' : ''}
                </div>
            `;
            
            const matchesGrid = document.createElement('div');
            matchesGrid.className = 'league-matches';
            
            // Sort matches by date
            group.matches.sort((a, b) => {
                const dateA = new Date(a.parsed_datetime || a.date_time);
                const dateB = new Date(b.parsed_datetime || b.date_time);
                return dateA - dateB;
            });
            
            group.matches.forEach(match => {
                const matchCard = createMatchCard(match, isLive, group);
                matchesGrid.appendChild(matchCard);
            });
            
            leagueSection.appendChild(leagueHeader);
            leagueSection.appendChild(matchesGrid);
            container.appendChild(leagueSection);
        }

        function createMatchCard(match, isLive, group) {
            const teams = match.matchup.split(' – ');
            const homeTeam = teams[0]?.trim();
            const awayTeam = teams[1]?.trim();
            const homeLogo = match.team_logos[0]?.logo_url;
            const awayLogo = match.team_logos[1]?.logo_url;
            const time = formatTime(match.parsed_datetime || match.date_time);
            const matchId = match.event_id || `${homeTeam}-${awayTeam}-${Date.now()}`;
            const startTime = match.parsed_datetime || match.date_time;
            
            const card = document.createElement('div');
            card.className = `match-card ${isLive ? 'live' : 'upcoming'}`;
            card.dataset.matchId = matchId;
            card.dataset.startTime = startTime;
            
            card.innerHTML = `
                <div class="match-status ${isLive ? 'status-live' : 'status-upcoming'}">
                    ${isLive ? 'LIVE' : 'UPCOMING'}
                </div>
                
                <div class="match-info-header">
                    <div class="match-league">${group.displayName}</div>
                    <div class="match-time">${time}</div>
                </div>
                
                <div class="teams-display">
                    <div class="team">
                        <div class="team-logo">
                            <img src="${getTeamLogo(homeTeam, homeLogo)}" alt="${homeTeam}" 
                                 onerror="this.onerror=null; this.src='${getTeamLogo(homeTeam, null)}'">
                        </div>
                        <div class="team-name">${homeTeam}</div>
                    </div>
                    
                    <div class="vs-divider">VS</div>
                    
                    <div class="team">
                        <div class="team-logo">
                            <img src="${getTeamLogo(awayTeam, awayLogo)}" alt="${awayTeam}"
                                 onerror="this.onerror=null; this.src='${getTeamLogo(awayTeam, null)}'">
                        </div>
                        <div class="team-name">${awayTeam}</div>
                    </div>
                    
                    ${!isLive ? `
                    <div class="countdown-container">
                        <span class="countdown-timer">${updateCountdown(matchId, startTime)}</span>
                    </div>
                    ` : ''}
                </div>
                
                <div class="watch-btn-container">
                    <button class="watch-btn">
                        <i class="fas fa-eye"></i> PREVIEW
                    </button>
                </div>
            `;
            
            card.querySelector('.watch-btn').addEventListener('click', () => {
                openPreview(match, group);
            });
            
            return card;
        }

        // ===== NOTIFICATION SYSTEM =====
        function showNotification(title, message, isReminder = true) {
            notificationTitle.textContent = title;
            notificationMessage.textContent = message;
            notificationBar.classList.add('show');
            
            if (isReminder) {
                setTimeout(() => {
                    hideNotification();
                }, 5000);
            }
        }

        function hideNotification() {
            notificationBar.classList.remove('show');
        }

        // ===== PREVIEW MODAL =====
        function openPreview(match, group) {
            currentModalMatch = match;
            
            const teams = match.matchup.split(' – ');
            const homeTeam = teams[0]?.trim();
            const awayTeam = teams[1]?.trim();
            const homeLogo = match.team_logos[0]?.logo_url;
            const awayLogo = match.team_logos[1]?.logo_url;
            const time = formatTime(match.parsed_datetime || match.date_time);
            const displayCompetition = group ? group.displayName : match.competition;
            const isHotCompetition = group ? group.hot : false;
            
            document.getElementById('modalTitle').textContent = `${homeTeam} vs ${awayTeam}`;
            
            const modalCompetition = document.getElementById('modalCompetition');
            modalCompetition.textContent = displayCompetition;
            
            if (isHotCompetition) {
                modalCompetition.innerHTML = `${displayCompetition} <span style="color: var(--hot-color); margin-left: 10px;"><i class="fas fa-fire"></i> PREMIUM</span>`;
            }
            
            document.getElementById('modalTeams').innerHTML = `
                <div class="modal-team">
                    <div class="modal-team-logo">
                        <img src="${getTeamLogo(homeTeam, homeLogo)}" alt="${homeTeam}"
                             onerror="this.onerror=null; this.src='${getTeamLogo(homeTeam, null)}'">
                    </div>
                    <div class="modal-team-name">${homeTeam}</div>
                </div>
                <div class="modal-vs">VS</div>
                <div class="modal-team">
                    <div class="modal-team-logo">
                        <img src="${getTeamLogo(awayTeam, awayLogo)}" alt="${awayTeam}"
                             onerror="this.onerror=null; this.src='${getTeamLogo(awayTeam, null)}'">
                    </div>
                    <div class="modal-team-name">${awayTeam}</div>
                </div>
            `;
            
            populateStreamLinks(match);
                
            matchModal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        // ===== POPULATE STREAM LINKS =====
        function populateStreamLinks(match) {
            if (!match.streams || match.streams.length === 0) {
                streamsList.innerHTML = `
                    <div class="no-streams">
                        <i class="fas fa-tv-slash"></i>
                        <h4>No Streams Available</h4>
                        <p>Stream links will appear closer to match time</p>
                    </div>
                `;
                modalStreams.classList.remove('active');
                return;
            }
            
            // Filter only Aliez.tv streams
            const aliezStreams = match.streams.filter(stream => 
                stream.stream_url && 
                (stream.stream_url.includes('aliez.tv') || 
                 stream.stream_url.includes('alieztv') ||
                 stream.stream_url.includes('webplayer2.php') ||
                 stream.stream_url.includes('player/live.php'))
            );
            
            if (aliezStreams.length === 0) {
                streamsList.innerHTML = `
                    <div class="no-streams">
                        <i class="fas fa-exclamation-triangle"></i>
                        <h4>No Premium Streams</h4>
                        <p>No encrypted streams available for this match</p>
                    </div>
                `;
                modalStreams.classList.remove('active');
                return;
            }
            
            streamsList.innerHTML = aliezStreams.map((stream, index) => {
                const language = stream.language || 'English';
                const quality = stream.bitrate || stream.stream_type || 'HD';
                const streamId = extractAliezStreamId(stream.stream_url);
                
                // Add quality badge
                let qualityBadge = '';
                if (quality.toLowerCase().includes('4k') || quality.toLowerCase().includes('uhd')) {
                    qualityBadge = '<span class="quality-badge quality-uhd">4K</span>';
                } else if (quality.toLowerCase().includes('1080') || quality.toLowerCase().includes('fhd')) {
                    qualityBadge = '<span class="quality-badge quality-fhd">FHD</span>';
                } else if (quality.toLowerCase().includes('720') || quality.toLowerCase().includes('hd')) {
                    qualityBadge = '<span class="quality-badge quality-hd">HD</span>';
                }
                
                return `
                    <div class="stream-item" onclick="playAliezStream('${streamId}', '${currentModalMatch.matchup}', '${language}', '${quality}')">
                        <div class="stream-tv-icon">
                            <i class="fas fa-tv"></i>
                        </div>
                        <div class="stream-watch-now">PREMIUM STREAM</div>
                        <div class="stream-language">${language} ${qualityBadge}</div>
                        <div class="stream-quality">Encrypted • No Pop-ups</div>
                    </div>
                `;
            }).join('');
            
            modalStreams.classList.add('active');
        }

        function closeModal() {
            matchModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            currentModalMatch = null;
        }

        // ===== PLAY ALIEZ.TV STREAM =====
        function playAliezStream(streamId, matchTitle, language = 'English', quality = 'HD') {
            closeModal();
            
            currentStreamId = streamId;
            
            // Show player modal
            playerMatchTitle.textContent = matchTitle;
            playerModal.classList.add('active');
            document.body.style.overflow = 'hidden';
            
            // Reset state
            isPlaying = false;
            serverRetryCount = 0;
            errorOverlay.style.display = 'none';
            streamStats.style.display = 'none';
            serverSelection.style.display = 'none';
            playerControls.classList.add('hidden');
            
            // Show premium ad overlay
            premiumAdOverlay.style.display = 'flex';
            
            // Clear player frame
            playerFrame.src = '';
            
            // Update quality selector based on stream quality
            if (quality.toLowerCase().includes('4k') || quality.toLowerCase().includes('uhd')) {
                qualitySelector.value = 'uhd';
            } else if (quality.toLowerCase().includes('1080') || quality.toLowerCase().includes('fhd')) {
                qualitySelector.value = 'fhd';
            } else {
                qualitySelector.value = 'hd';
            }
            
            // Show notification
            showNotification('Premium Stream', 'Click START STREAMING to begin');
        }

        function startPremiumStream() {
            // Hide ad overlay
            premiumAdOverlay.style.display = 'none';
            
            // Show loading spinner
            loadingSpinner.style.display = 'block';
            
            // Hide error overlay if shown
            errorOverlay.style.display = 'none';
            
            // Build secure stream URL
            const streamUrl = buildSecureStreamUrl(currentStreamId);
            currentStreamUrl = streamUrl;
            
            console.log('Loading encrypted stream:', streamUrl);
            
            // Load player with timeout
            const loadTimeout = setTimeout(() => {
                if (!isPlaying) {
                    handleStreamError();
                }
            }, 10000);
            
            // Set up player frame
            playerFrame.onload = function() {
                clearTimeout(loadTimeout);
                loadingSpinner.style.display = 'none';
                isPlaying = true;
                serverSelection.style.display = 'block';
                streamStats.style.display = 'block';
                playerControls.classList.remove('hidden');
                serverRetryCount = 0;
                
                showNotification('Stream Started', 'Premium stream is now playing');
            };
            
            playerFrame.onerror = function() {
                clearTimeout(loadTimeout);
                handleStreamError();
            };
            
            // Load the stream
            playerFrame.src = streamUrl;
        }

        function handleStreamError() {
            loadingSpinner.style.display = 'none';
            
            if (serverRetryCount < MAX_RETRIES) {
                serverRetryCount++;
                
                // Try next server
                currentServerIndex = (currentServerIndex + 1) % availableServers.length;
                
                // Show notification
                showNotification(`Retrying`, `Server ${serverRetryCount}/${MAX_RETRIES}`, false);
                
                // Retry after delay
                setTimeout(startPremiumStream, 1000);
            } else {
                // Show error overlay
                errorOverlay.style.display = 'flex';
                isPlaying = false;
                
                // Add fallback servers if available
                if (availableServers.length === ALIEZ_SERVERS.length) {
                    availableServers = [...availableServers, ...FALLBACK_SERVERS];
                    updateServerSelector();
                }
            }
        }

        function retryConnection() {
            errorOverlay.style.display = 'none';
            serverRetryCount = 0;
            startPremiumStream();
        }

        function changeServer() {
            const selectedIndex = parseInt(serverSelector.value);
            if (!isNaN(selectedIndex) && selectedIndex >= 0 && selectedIndex < availableServers.length) {
                currentServerIndex = selectedIndex;
                startPremiumStream();
            }
        }

        function togglePlayPause() {
            if (isPlaying) {
                // Pause logic would go here if we had direct control
                playPauseBtn.innerHTML = '<i class="fas fa-play"></i>';
                isPlaying = false;
            } else {
                // Play logic
                playPauseBtn.innerHTML = '<i class="fas fa-pause"></i>';
                isPlaying = true;
            }
        }

        function toggleFullscreen() {
            if (!isFullscreen) {
                const container = playerModal.querySelector('.player-container');
                if (container.requestFullscreen) {
                    container.requestFullscreen();
                } else if (container.webkitRequestFullscreen) {
                    container.webkitRequestFullscreen();
                } else if (container.msRequestFullscreen) {
                    container.msRequestFullscreen();
                }
                isFullscreen = true;
                fullscreenBtn.innerHTML = '<i class="fas fa-compress"></i>';
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                } else if (document.webkitExitFullscreen) {
                    document.webkitExitFullscreen();
                } else if (document.msExitFullscreen) {
                    document.msExitFullscreen();
                }
                isFullscreen = false;
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
            }
        }

        function closePlayer() {
            playerModal.classList.remove('active');
            document.body.style.overflow = 'auto';
            
            // Reset state
            isPlaying = false;
            playerFrame.src = '';
            premiumAdOverlay.style.display = 'flex';
            errorOverlay.style.display = 'none';
            loadingSpinner.style.display = 'none';
            streamStats.style.display = 'none';
            serverSelection.style.display = 'none';
            playerControls.classList.add('hidden');
            
            // Exit fullscreen if active
            if (isFullscreen && document.exitFullscreen) {
                document.exitFullscreen();
                isFullscreen = false;
                fullscreenBtn.innerHTML = '<i class="fas fa-expand"></i>';
            }
        }

        // ===== VIEW MANAGEMENT =====
        function switchView(view) {
            currentView = view;
            
            dockItems.forEach(item => {
                item.classList.toggle('active', item.dataset.view === view);
            });
            
            switch(view) {
                case 'home':
                    backBtn.style.display = 'none';
                    sectionTitle.innerHTML = '<i class="fas fa-broadcast-tower"></i> Live Matches';
                    liveContainer.style.display = 'block';
                    upcomingContainer.style.display = 'block';
                    break;
                    
                case 'live':
                    backBtn.style.display = 'flex';
                    sectionTitle.innerHTML = '<i class="fas fa-broadcast-tower"></i> Live Matches';
                    liveContainer.style.display = 'block';
                    upcomingContainer.style.display = 'none';
                    break;
                    
                case 'upcoming':
                    backBtn.style.display = 'flex';
                    sectionTitle.innerHTML = '<i class="far fa-clock"></i> Upcoming Matches';
                    liveContainer.style.display = 'none';
                    upcomingContainer.style.display = 'block';
                    break;
            }
            
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // ===== HELPER FUNCTIONS =====
        function formatTime(dateTime) {
            if (!dateTime) return 'TBD';
            
            try {
                // Handle ISO format
                if (dateTime.includes('T')) {
                    const date = new Date(dateTime);
                    if (isNaN(date.getTime())) return dateTime;
                    
                    const now = new Date();
                    const today = new Date(now.getFullYear(), now.getMonth(), now.getDate());
                    const matchDate = new Date(date.getFullYear(), date.getMonth(), date.getDate());
                    
                    const timeStr = date.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
                    
                    if (matchDate.getTime() === today.getTime()) {
                        return `${timeStr} Today`;
                    } else if (matchDate.getTime() === today.getTime() + 86400000) {
                        return `${timeStr} Tomorrow`;
                    } else {
                        const monthNames = ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'];
                        return `${monthNames[date.getMonth()]} ${date.getDate()}, ${timeStr}`;
                    }
                } else {
                    // Handle "27 December at 13:30" format
                    return dateTime.replace(' at ', ' ');
                }
            } catch (e) {
                console.error('Error formatting time:', e);
                return dateTime;
            }
        }

        // ===== EVENT LISTENERS =====
        function setupEventListeners() {
            backBtn.addEventListener('click', () => switchView('home'));
            refreshBtn.addEventListener('click', loadData);
            
            dockItems.forEach(item => {
                item.addEventListener('click', function() {
                    switchView(this.dataset.view);
                });
            });
            
            modalClose.addEventListener('click', closeModal);
            matchModal.addEventListener('click', function(e) {
                if (e.target === matchModal) closeModal();
            });
            
            modalWatchBtn.addEventListener('click', function() {
                if (!currentModalMatch) return;
                const aliezStream = currentModalMatch.streams?.find(stream => 
                    stream.stream_url && stream.stream_url.includes('webplayer2.php?t=alieztv')
                );
                if (aliezStream) {
                    const streamId = extractAliezStreamId(aliezStream.stream_url);
                    playAliezStream(streamId, currentModalMatch.matchup);
                }
            });
            
            // Search functionality
            searchBtn.addEventListener('click', performSearch);
            searchBar.addEventListener('keyup', function(e) {
                if (e.key === 'Enter') {
                    performSearch();
                }
            });
            
            let searchTimeout;
            searchBar.addEventListener('input', function() {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(performSearch, 300);
            });
            
            // Notification close
            notificationClose.addEventListener('click', hideNotification);
            
            // Player modal events
            playerClose.addEventListener('click', closePlayer);
            playerModal.addEventListener('click', function(e) {
                if (e.target === playerModal) closePlayer();
            });
            
            premiumAdBtn.addEventListener('click', startPremiumStream);
            retryBtn.addEventListener('click', retryConnection);
            
            // Player controls
            playPauseBtn.addEventListener('click', togglePlayPause);
            fullscreenBtn.addEventListener('click', toggleFullscreen);
            qualitySelector.addEventListener('change', function() {
                // Quality change logic would go here
                showNotification('Quality Changed', `Stream quality set to ${this.options[this.selectedIndex].text}`);
            });
            
            serverSelector.addEventListener('change', changeServer);
            
            // Fullscreen change detection
            document.addEventListener('fullscreenchange', handleFullscreenChange);
            document.addEventListener('webkitfullscreenchange', handleFullscreenChange);
            document.addEventListener('msfullscreenchange', handleFullscreenChange);
            
            function handleFullscreenChange() {
                isFullscreen = !!(document.fullscreenElement || 
                                document.webkitFullscreenElement || 
                                document.msFullscreenElement);
                
                fullscreenBtn.innerHTML = isFullscreen ? 
                    '<i class="fas fa-compress"></i>' : 
                    '<i class="fas fa-expand"></i>';
            }
            
            // Auto-hide controls
            let controlsTimeout;
            playerFrameContainer = document.querySelector('.player-frame-container');
            
            playerFrameContainer.addEventListener('mousemove', function() {
                playerControls.classList.remove('hidden');
                clearTimeout(controlsTimeout);
                controlsTimeout = setTimeout(() => {
                    if (isPlaying) {
                        playerControls.classList.add('hidden');
                    }
                }, 3000);
            });
            
            // Auto-refresh data every 2 minutes
            setInterval(() => {
                if (currentView === 'live' || currentView === 'home') {
                    loadData();
                }
            }, 120000);
            
            // Update countdown timers every second
            setInterval(() => {
                startCountdownTimers();
            }, 1000);
        }

        // ===== GLOBAL FUNCTIONS =====
        window.openPreview = openPreview;
        window.loadData = loadData;
        window.switchView = switchView;
        window.performSearch = performSearch;
        window.showNotification = showNotification;
        window.hideNotification = hideNotification;
        window.playAliezStream = playAliezStream;
        window.closePlayer = closePlayer;
        window.startPremiumStream = startPremiumStream;
        window.retryConnection = retryConnection;
        window.changeServer = changeServer;
    </script>
</body>
</html>
